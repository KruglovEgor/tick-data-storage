# Система хранения тиковых данных

Тестовое задание по созданию системы обработки и хранения тиковых данных биржевых заявок с поддержкой PostgreSQL и SQLite.

## Требования

- Python 3.8+
- Docker и Docker Compose (для PostgreSQL)
- pip

## Установка и запуск

### 1. Клонирование репозитория
```bash
git clone https://github.com/KruglovEgor/tick-data-storage.git
cd tick-data-storage
```

### 2. Установка зависимостей
```bash
pip install -r requirements.txt
```

### 3. Запуск PostgreSQL через Docker
```bash
docker-compose up -d
```

### 4. Запуск тестов

#### SQLite версия
```bash
python -m src.main_sqlite
```

#### PostgreSQL версия
```bash
python -m src.main_postgres
```

## Архитектура

```
src/
├── db/                    # Слой базы данных
│   ├── __init__.py
│   ├── base.py           # Абстрактный интерфейс
│   ├── postgres.py       # PostgreSQL реализация
│   └── sqlite.py         # SQLite реализация
├── processor.py          # Универсальный процессор
├── queries.py            # SQL запросы
├── main_postgres.py      # Точка входа для PostgreSQL
└── main_sqlite.py        # Точка входа для SQLite
```

## Возможности

- Обработка CSV файлов с тиковыми данными
- Поддержка PostgreSQL и SQLite
- Эффективная обработка больших файлов (порциями)
- Хранение истории всех операций
- Отслеживание активных заявок
- Быстрые запросы для получения лучших цен покупки и продажи

## Типы событий

- `1` - Выставление заявки
- `2` - Сделка (частичное или полное исполнение)
- `0` - Снятие заявки

## Формат данных

CSV файл должен содержать колонки:
- `symbol` - инструмент
- `type` - тип операции (B/S)
- `moment` - временная метка
- `id` - ID заявки
- `action` - тип события (1-выставление, 2-сделка, 0-снятие)
- `price` - цена
- `volume` - объем

## Тестовые данные

В папке `resources/` находятся тестовые файлы:
- `20241001_fut_ord_50k.csv` - файл с первыми 50000 строками для тестирования (сократил для удобства)